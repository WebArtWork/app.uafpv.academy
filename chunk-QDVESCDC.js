import{a as V}from"./chunk-C7TNO6B4.js";import{b as U,h as q}from"./chunk-R3HM3236.js";import{$ as o,$a as E,A as h,Cb as L,Db as N,Ka as b,L as m,O as s,P as k,Q as y,U as I,W as c,Xa as x,_ as n,a as S,ab as p,b as w,da as f,ea as a,fa as _,gb as M,lb as j,mb as P,oa as g,qb as T,sb as F,u as C,z as d}from"./chunk-2Y7ZGU6E.js";function W(t,D){if(t&1){let e=f();n(0,"span",9),a("click",function(){d(e);let i=_();return h(i.us.setMode("dark"))}),g(1," dark_mode "),o()}}function z(t,D){if(t&1){let e=f();n(0,"span",10),a("click",function(){d(e);let i=_();return h(i.us.setMode())}),g(1," light_mode "),o()}}var B=(()=>{class t{constructor(e,r,i,u,R,A,H,J){this.us=e,this.ui=r,this._alert=i,this._http=u,this._router=R,this._form=A,this._translate=H,this._core=J,this.form=this._form.getForm("sign",{formId:"sign",title:"Sign In / Sign Up",components:[{name:"Email",key:"email",focused:!0,required:!0,fields:[{name:"Placeholder",value:"Enter your email"},{name:"Label",value:"Email"}]},{name:"Password",key:"password",required:!0,fields:[{name:"Placeholder",value:"Enter your password"},{name:"Label",value:"Password"}]},{name:"Number",key:"resetPin",fields:[{name:"Placeholder",value:"Enter code from email"},{name:"Label",value:"code"}],hidden:!0},{name:"Button",fields:[{name:"Label",value:"Let's go"},{name:"Submit",value:!0},{name:"Click",value:()=>{this.submit()}}]}]}),this.user=w(S({},p.user),{resetPin:null}),this._set=l=>{if(l){let v=l.token||"";v&&this._http.set("token",v),this._core.emit("wipe"),localStorage.setItem("waw_user",JSON.stringify(l)),this.us.setUser(l),this.us.get({query:p.appId?"appId="+p.appId:""}),this._router.navigateByUrl("/profile")}else this._alert.error({text:"Something went wrong"})}}submit(){!this.form.components[2].hidden&&this.user.resetPin?this.save():this.user.email||this._alert.error({text:this._translate.translate("Sign.Enter your email")}),this.ui.valid(this.user.email)?this.user.password?this._http.post("/api/user/status",this.user,e=>{e.email&&e.pass?this.login():e.email?this.reset():this.sign()}):this._alert.error({text:this._translate.translate("Sign.Enter your password")}):this._alert.error({text:this._translate.translate("Sign.Enter proper email")})}login(){this._http.post("/api/user/login",this.user,this._set.bind(this))}sign(){this._http.post("/api/user/sign",this.user,this._set.bind(this))}reset(){this._http.post("/api/user/request",this.user,()=>{this.form.components[2].hidden=!1}),this._alert.info({text:"Mail will sent to your email"})}save(){this._http.post("/api/user/change",this.user,e=>{e?this._alert.info({text:"Password successfully changed"}):this._alert.error({text:"Wrong Code"}),this.login()})}static{this.\u0275fac=function(r){return new(r||t)(s(V),s(T),s(P),s(j),s(x),s(L),s(F),s(M))}}static{this.\u0275cmp=k({type:t,selectors:[["ng-component"]],standalone:!1,decls:9,vars:4,consts:[[1,"auth-wrapper"],[1,"auth__wrap"],[1,"auth__img"],[3,"click"],[1,"auth__form"],[1,"auth"],["class","material-icons",3,"click",4,"ngIf"],["class","material-icons auth__icon",3,"click",4,"ngIf"],[3,"wSubmit","submition","config"],[1,"material-icons",3,"click"],[1,"material-icons","auth__icon",3,"click"]],template:function(r,i){r&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"icon-spider",3),a("click",function(){return i.us.setMode(i.us.mode?"":"dark")}),o()(),n(4,"div",4)(5,"div",5),I(6,W,2,0,"span",6)(7,z,2,0,"span",7),n(8,"wform",8),a("wSubmit",function(){return i.submit()}),o()()()()()),r&2&&(m(6),c("ngIf",!i.us.mode),m(),c("ngIf",i.us.mode),m(),c("submition",i.user)("config",i.form))},dependencies:[b,N,U],encapsulation:2})}}return t})();var G=[{path:"",component:B}],le=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=y({type:t})}static{this.\u0275inj=C({imports:[E.forChild(G),q]})}}return t})();export{le as SignModule};
